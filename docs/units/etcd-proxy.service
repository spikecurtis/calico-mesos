[Unit]
Description=etcd-proxy
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
EnvironmentFile=/etc/sysconfig/etcd-proxy
ExecStartPre=-/usr/bin/docker kill etcd-proxy
ExecStartPre=-/usr/bin/docker rm etcd-proxy
ExecStart=/usr/bin/docker run --name etcd-proxy \
  --net host \
  quay.io/coreos/etcd:v2.2.0 \
  --listen-client-urls "http://127.0.0.1:2379,http://127.0.0.1:4001" \
  --initial-cluster "${INITIAL_CLUSTER}" \
  --proxy on

[Install]
WantedBy=multi-user.target